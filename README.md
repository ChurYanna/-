# 工业网络 Socket（Python）服务器-客户端收发示例

满足：
1) 工业应用场景下，使用 Socket 编程，实现服务器-客户端之间数据收发
2) 收发内容包含：字符数据 + 二进制文件（图片/语音/任意文件都可）

## 文件说明
- server.py：服务端（接收文本/文件，文件保存到 recv_files/，并回 ACK）
- client.py：客户端（交互式发送文本或发送文件）
- common_protocol.py：极简协议封装（解决粘包/拆包）

## 运行方式（Windows）

### 1) 启动服务端
在本目录打开终端运行：

`python server.py`

默认监听：0.0.0.0:9000

### 2) 启动客户端
另开一个终端：

`python client.py`

- 服务端IP：本机测试输入回车（默认 127.0.0.1）
- 端口：回车默认 9000

然后按菜单发送：
- 文本：直接输入字符串
- 文件：输入文件路径（例如图片 .jpg/.png 或音频 .wav/.mp3 或任意 .bin）

服务端会把文件保存到：`recv_files/`

## 可视化客户端（窗口版）
如果你希望在窗口里直接连接/发送文本/发送文件：

1) 先启动服务端：`python server.py`
2) 再启动窗口客户端：`python client_gui.py`

窗口里：
- IP/端口：填好后点“连接”
- 文本：输入后点“发送文本”
- 文件：点“发送文件”选择图片/音频/任意文件

## 可视化服务端（窗口版）
如果你希望服务端也用窗口操作（启动/停止、选择保存目录、看日志）：

1) 启动窗口服务端：`python server_gui.py`
2) 再用命令行客户端或窗口客户端连接：
  - `python client.py` 或 `python client_gui.py`

窗口服务端里：
- 设置监听 IP/端口，点“启动”
- “保存目录”可选择接收文件的落盘位置
- 日志会显示客户端连接、收到的文本、收到的文件名与大小

## 说明（尽量简单）
- 这里使用 TCP；为了避免“粘包”，自定义了一个固定长度消息头：
  - MAGIC(4字节) + 类型(1字节) + 文件名长度(2字节) + 数据长度(8字节)
- 文本消息：类型=1，只有 data
- 文件消息：类型=2，name=文件名，data=文件内容（二进制）

## 常见问题
- 如果发送大文件很慢：这是正常的，TCP 会按网络情况分段发送；示例为了简单一次性读入内存。
- 如果要更工业化：可以把文件改成“分片发送/断点续传/校验CRC”等（本示例先不做）。
